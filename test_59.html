<!DOCTYPE html>
<html>
<head>
    <title>Test Diklat 59-01825-89</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f0f0f0; }
        .container { background: white; padding: 20px; border-radius: 8px; max-width: 800px; }
        .forced { background: yellow; padding: 15px; border: 3px solid red; margin: 15px 0; }
        .log { background: #f8f9fa; padding: 10px; margin: 5px 0; border-left: 4px solid #007bff; }
        .success { border-left-color: green; background: #d4edda; }
        .error { border-left-color: red; background: #f8d7da; }
        h1 { color: #333; }
        select { width: 100%; padding: 10px; font-size: 16px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• FINAL TEST: Diklat 59-01825-89 üî•</h1>
        
        <div class="forced">
            <h2>‚ö†Ô∏è MODE PAKSA AKTIF ‚ö†Ô∏è</h2>
            <p><strong>Diklat ID:</strong> 59-01825-89</p>
            <p><strong>Mode:</strong> TANGGAL DIPAKSA (TIDAK ADA GELOMBANG)</p>
        </div>
        
        <h3 id="main-heading">üîÑ Loading...</h3>
        <p id="main-description">üîÑ Loading...</p>
        
        <select id="gelombang-select">
            <option>üîÑ Loading...</option>
        </select>
        
        <div id="logs"></div>
    </div>
    
    <script>
        function addLog(message, type = 'log') {
            const logsDiv = document.getElementById('logs');
            const logElement = document.createElement('div');
            logElement.className = 'log ' + type;
            logElement.innerHTML = '<strong>' + new Date().toLocaleTimeString() + ':</strong> ' + message;
            logsDiv.appendChild(logElement);
            console.log(message);
        }
        
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            return date.getDate() + ' ' + months[date.getMonth()] + ' ' + date.getFullYear();
        }
        
        window.onload = function() {
            addLog('üöÄ Starting test for diklat 59-01825-89', 'success');
            
            // IMMEDIATE UI FORCE
            document.getElementById('main-heading').innerHTML = 'üìÖ TANGGAL MODE DIPAKSA';
            document.getElementById('main-description').textContent = 'MODE TANGGAL DIPAKSA - TIDAK ADA GELOMBANG!';
            addLog('‚úÖ UI forced to TANGGAL mode immediately', 'success');
            
            // Test API
            const diklatId = '59-01825-89';
            const apiUrl = `http://localhost/tugas1_tmu1/pendaftaran/get_periode_list/${diklatId}`;
            
            addLog('üì° Calling API: ' + apiUrl, 'log');
            
            fetch(apiUrl)
                .then(response => {
                    addLog('üì° Response status: ' + response.status, 'log');
                    return response.json();
                })
                .then(response => {
                    addLog('üìä API Response received', 'success');
                    addLog('üîç use_gelombang: ' + response.use_gelombang + ' (AKAN DIABAIKAN)', 'log');
                    addLog('üîç total_periode: ' + response.total_periode, 'log');
                    addLog('üîç data length: ' + (response.data ? response.data.length : 0), 'log');
                    
                    const data = response.data || [];
                    const select = document.getElementById('gelombang-select');
                    
                    // PAKSA TANGGAL MODE
                    addLog('üî• MEMAKSA TANGGAL MODE - MENGABAIKAN API', 'success');
                    
                    let options = '<option value="">-- PILIH TANGGAL (DIPAKSA) --</option>';
                    
                    if (data.length > 0) {
                        const validData = data.filter(item => 
                            item.kouta > 0 && 
                            item.is_exist == 1 && 
                            item.pelaksanaan_mulai && 
                            item.pelaksanaan_akhir
                        );
                        
                        addLog('‚úÖ Valid data untuk tanggal: ' + validData.length + ' items', 'success');
                        
                        if (validData.length > 0) {
                            validData.forEach(item => {
                                const startDate = formatDate(item.pelaksanaan_mulai);
                                const endDate = formatDate(item.pelaksanaan_akhir);
                                const dateRange = `${startDate} - ${endDate}`;
                                options += `<option value="${item.periode}">üìÖ ${dateRange} (Periode ${item.periode})</option>`;
                            });
                            
                            addLog('‚úÖ Dropdown diisi dengan ' + validData.length + ' pilihan TANGGAL', 'success');
                        } else {
                            addLog('‚ö†Ô∏è Tidak ada data valid untuk mode tanggal', 'error');
                        }
                    } else {
                        addLog('‚ö†Ô∏è Tidak ada data dari API', 'error');
                    }
                    
                    select.innerHTML = options;
                    addLog('üéâ SUKSES: Dropdown berhasil diset ke mode TANGGAL!', 'success');
                })
                .catch(error => {
                    addLog('‚ùå Error: ' + error.message, 'error');
                });
        };
    </script>
</body>
</html>
